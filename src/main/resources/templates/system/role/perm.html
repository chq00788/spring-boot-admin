<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>角色权限</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" th:href="@{/static/layuiadmin/layui/css/layui.css}" media="all">
</head>
<body>

<form class="layui-form">
    <input th:value="${role.id}" name="id" hidden>
    <div class="layui-form-item">
        <label class="layui-form-label">选择权限</label>
        <div class="layui-input-block">
            <div id="LAY-auth-tree-index"></div>
        </div>
    </div>
    <div class="layui-form-item layui-hide">
        <button class="layui-btn" lay-submit lay-filter="LAY-user-role-submit" id="LAY-user-role-submit">提交</button>
    </div>
</form>
<script th:src="@{/static/layuiadmin/layui/layui.js}"></script>
<script>
    layui.config({
        base: '/static/layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'form', 'authtree'], function () {
        var $ = layui.$
            , form = layui.form;
        var authtree = layui.authtree;
        var layer = layui.layer;
        // 一般来说，权限数据是异步传递过来的
        $.ajax({
            url: 'getPermList?id='+[[${role.id}]],
            dataType: 'json',
            success: function (data) {
                var trees = authtree.listConvert(data.result, {
                    primaryKey: 'id'
                    , parentKey: 'permPid'
                    , nameKey: 'permName'
                    , valueKey: 'id'
                });
                // 如果后台返回的不是树结构，请使用 authtree.listConvert 转换
                authtree.render('#LAY-auth-tree-index', trees, {
                    inputname: 'authids[]',
                    layfilter: 'lay-check-auth',
                    autowidth: true,
                });
            }
        });
    })
</script>
</body>
</html>